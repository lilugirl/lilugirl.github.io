var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,s=(e,t)=>{for(var o in t||(t={}))l.call(t,o)&&r(e,o,t[o]);if(n)for(var o of n(t))a.call(t,o)&&r(e,o,t[o]);return e};import{u as i,D as c,c as d,a as u,R as m,S as p,b as h,d as E,e as g,f,N as b,H as v,g as y,h as w,i as k,P as _}from"./vendor.24ac2a95.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(o){const n=new URL(e,location),l=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((o,a)=>{const r=new URL(e,n);if(self[t].moduleMap[r])return o(self[t].moduleMap[r]);const s=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){a(new Error(`Failed to import: ${e}`)),l(i)},onload(){o(self[t].moduleMap[r]),l(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/assets/");function S(){const{pathname:e}=i();return c.exports.useEffect((()=>{window.scrollTo(0,0)}),[e]),null}const P=d({name:"app",initialState:{loading:!1},reducers:{setLoading(e,t){e.loading=t.payload}}}),{setLoading:x}=P.actions,O=e=>e.app.loading;var T=P.reducer;const j=d({name:"auth",initialState:{token:window.localStorage.getItem("token")?window.localStorage.getItem("token"):"",role:window.localStorage.getItem("role")?window.localStorage.getItem("role"):""},reducers:{setToken(e,t){e.token=t.payload},setRole(e,t){e.role=t.payload}}}),I=e=>e.auth.token,L=e=>e.auth.role;var R=j.reducer;const F=({routes:e})=>{const n=u(L),l=e.filter((e=>e.component)),a=e.filter((e=>e.to));return m.createElement(m.Fragment,null,m.createElement(p,null,a.map(((e,t)=>m.createElement(h,{exact:!0,from:e.from,to:e.to,key:t}))),l.map(((e,l)=>m.createElement(E,{key:e.path,path:e.path,render:l=>{var a,r;return e.title&&e.subtitle&&(l.location.state=(a=s({},l.location.state),r={title:e.title,subtitle:e.subtitle},t(a,o(r)))),!(e.authority&&e.authority.length>0)||n&&e.authority.includes(n)?m.createElement(e.component,s({},l)):m.createElement(h,{from:e.path,to:e.redirectPath||"/login"})}})))))};let D;const U={},A=function(e,t){if(!t)return e();if(void 0===D){const e=document.createElement("link").relList;D=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in U)return;U[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":D,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))},C=d({name:"nav",initialState:{title:"",subtitle:""},reducers:{setTitle(e,t){console.log("setTitle payload",t),e.title=t.payload},setSubTitle(e,t){console.log("setsubTitle payload",t),e.subtitle=t.payload}}}),{setTitle:$,setSubTitle:z}=C.actions,M=e=>e.nav.title,N=e=>e.nav.subtitle;var G=C.reducer;const V=()=>{const e=u(M),t=u(N);return m.createElement("div",null,e,"   ",t&&"> "+t," ")},q=()=>m.createElement("div",null,"page is not found"),B=g.create({timeout:5e3,withCredentials:!0,responseType:"json"});B.interceptors.request.use((e=>(e.headers.Authorization=(window.localStorage.getItem("token"),window.localStorage.getItem("token")),e))),B.interceptors.response.use((e=>200===e.status?e.data:e),(e=>{console.log("拦截错误",e)}));const H=[{from:"/dashboard/user",to:"/dashboard/user/list"},{path:"/dashboard/user/list",component:()=>(c.exports.useEffect((()=>{B.get("/index-infos").then((e=>{console.log("res",e)}))})),m.createElement("div",null,"list of user ")),title:"用户管理",subtitle:"用户列表"},,{path:"/dashboard/user/add",component:e=>(console.log("add props",e),m.createElement("div",null,"add user")),title:"用户管理",subtitle:"添加用户"},{path:"*",component:q}],W=[{from:"/dashboard/product",to:"/dashboard/product/list"},{path:"/dashboard/product/list",component:()=>{const[e,t]=c.exports.useState({hotGoodses:[]});return c.exports.useEffect((()=>{B.get("/api/index-infos").then((e=>{console.log("res",e),t(e.data)}))}),[]),m.createElement("div",null,m.createElement("h2",null,"产品列表"),m.createElement("ul",null,"热门产品",e&&e.hotGoodses&&e.hotGoodses.length>0&&e.hotGoodses.map(((e,t)=>m.createElement("li",{key:t},e.goodsName)))))},title:"产品管理",subtitle:"产品列表"},,{path:"/dashboard/product/add",component:()=>m.createElement("div",null,"add localid"),title:"产品管理",subtitle:"添加产品"},{path:"*",component:q}],J=[{from:"/dashboard",to:"/dashboard/user"},{path:"/dashboard/user",component:e=>(console.log("user props",e),m.createElement("div",null,m.createElement(c.exports.Suspense,{fallback:m.createElement(m.Fragment,null,"loading")},m.createElement(F,{routes:H})))),title:"用户管理",subtitle:"用户列表",authority:["sysadmin"],redirectPath:"/dashboard/403"},{path:"/dashboard/product",component:()=>m.createElement("div",null,m.createElement(c.exports.Suspense,{fallback:m.createElement(m.Fragment,null,"loading")},m.createElement(F,{routes:W}))),title:"产品管理",subtitle:"产品列表",authority:["admin","sysadmin"],redirectPath:"/login"},{path:"/dashboard/403",component:c.exports.lazy((()=>A((()=>__import__("./403.5568800e.js")),["/assets/403.5568800e.js","/assets/vendor.24ac2a95.js"])))},{path:"*",component:q}],K=()=>{const e=u(I),t=f();return m.createElement(m.Fragment,null," ",e?"你好 "+e:"匿名",e&&m.createElement(m.Fragment,null,m.createElement("button",{onClick:()=>{var e;t((e=()=>{window.location.href="/#/login"},t=>{t(x(!0)),setTimeout((()=>{window.localStorage.setItem("token",""),window.localStorage.setItem("role",""),t(j.actions.setToken("")),t(j.actions.setRole("")),t(x(!1)),e&&e()}),200)}))}},"登出")),!e&&m.createElement(m.Fragment,null,m.createElement("button",{onClick:()=>{window.location.href="/#/login"}},"登录")))},Q=()=>m.createElement(m.Fragment,null,m.createElement(b,{to:"/dashboard/user"},"User"),m.createElement(b,{to:"/dashboard/product"},"Product")),X=()=>m.createElement(m.Fragment,null,"footer");const Y=c.exports.lazy((()=>A((()=>__import__("./index.c9a37edd.js")),["/assets/index.c9a37edd.js","/assets/vendor.24ac2a95.js"]))),Z=c.exports.lazy((()=>A((()=>__import__("./404.3f21f6a6.js")),["/assets/404.3f21f6a6.js","/assets/vendor.24ac2a95.js"]))),ee=[{from:"/",to:"/dashboard"},{path:"/dashboard",component:e=>{console.log("dashbaord props",e);const t=f();return c.exports.useEffect((()=>{var o,n,l,a,r,s,i,c;(null==(n=null==(o=null==e?void 0:e.location)?void 0:o.state)?void 0:n.title)&&t($(null==(a=null==(l=null==e?void 0:e.location)?void 0:l.state)?void 0:a.title)),(null==(s=null==(r=null==e?void 0:e.location)?void 0:r.state)?void 0:s.subtitle)&&t(z(null==(c=null==(i=null==e?void 0:e.location)?void 0:i.state)?void 0:c.subtitle))}),[null==e?void 0:e.location]),m.createElement(m.Fragment,null,m.createElement("section",{id:"dashboard-layout"},m.createElement("header",null,m.createElement(K,null)),m.createElement("nav",null,m.createElement(Q,null)),m.createElement("main",null,m.createElement(V,null),m.createElement(c.exports.Suspense,{fallback:m.createElement(m.Fragment,null)},m.createElement(F,{routes:J}))),m.createElement("footer",null,m.createElement(X,null))))},authority:["admin","sysadmin"],redirectPath:"/login"},{path:"/docs",component:Y,authority:["user","admin","sysadmin"],redirectPath:"/login"},{path:"/login",component:()=>{const e=f(),t=u(O);return m.createElement("div",{className:"login"},m.createElement("div",{className:"wrapper"},m.createElement("h2",null,"Login"),m.createElement("form",null,m.createElement("input",{placeholder:"用户名"}),m.createElement("input",{placeholder:"密码"}),m.createElement("button",{onClick:t=>{var o;t.preventDefault(),e((o=()=>{window.location.href="/dashboard"},e=>{e(x(!0)),setTimeout((()=>{window.localStorage.setItem("token","liuyi"),window.localStorage.setItem("role","admin"),e(j.actions.setToken("liuyi")),e(j.actions.setRole("admin")),e(x(!1)),o&&o()}),2e3)}))},disabled:t},"登录"))))}},{path:"/403",component:c.exports.lazy((()=>A((()=>__import__("./403.e5f5f03c.js")),["/assets/403.e5f5f03c.js","/assets/vendor.24ac2a95.js"])))},{path:"/404",component:Z},{path:"*",component:Z}];function te(){return m.createElement("div",{className:"App"},m.createElement(v,null,m.createElement(S,null),m.createElement(c.exports.Suspense,{fallback:m.createElement(m.Fragment,null)},m.createElement(F,{routes:ee}))))}const oe=w({reducer:y({app:T,auth:R,nav:G})});k.render(m.createElement(_,{store:oe},m.createElement(te,null)),document.getElementById("root"));
